{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay.js","../src/js/index.js"],"sourcesContent":["import axios from 'axios';\n\n\naxios.defaults.baseURL = \"https://pixabay.com/api/\";\nconst API_KEY = '40365251-7556fc461aeff4605ce69e2bc';\n\nexport const getPhotos = async (q, page = 1, per_page = 40) => {\n    const reqUrl = `?key=${API_KEY}&q=${q}&page=${page}&per_page=${per_page}&image_type=photo&orientation=horizontal&safesearch=true`;\n    const response = await axios.get(reqUrl);\n    return response.data;\n};","import iziToast from 'izitoast';\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { getPhotos } from './pixabay';\n\nconst form = document.querySelector('.search-form');\nconst gallery = document.querySelector('.gallery');\nconst btnLoadMore = document.querySelector('.load-more');\nlet currentPage = 1;\nlet per_page = 40;\ngallery.innerHTML = '';\n\nbtnLoadMore.classList.add('is-hidden');\n\nform.addEventListener('submit', async (evt) => {\n    evt.preventDefault();\n    currentPage = 1;\n    const query = evt.currentTarget.elements.searchQuery.value;\n    try {\n\n        const data = await getPhotos(query.trim().toLowerCase(), currentPage, per_page);\n        console.log('data', data)\n\n        if (data.total === 0) {\n            btnLoadMore.classList.add('is-hidden');\n            gallery.innerHTML = '';\n            iziToast.info({\n                message: 'For your request, no images were found. Please try again.',\n                position: 'topRight',\n                timeout: 4000,\n            })\n            return;\n        };\n        iziToast.info({\n            message: `Hooray! We found ${data.total} images.`,\n            position: 'topRight',\n            timeout: 4000,\n        });\n\n        gallery.innerHTML = markUp(data.hits).join('');\n        let idx = Math.floor(Math.random() * (data.hits.length - 1));\n        const bgImage = data.hits[idx].largeImageURL;\n        document.body.style.backgroundImage = `url(${bgImage})`;\n        if (data.total > 40) {\n            btnLoadMore.classList.remove('is-hidden');\n        } else {\n            btnLoadMore.classList.add('is-hidden');\n        };\n    } catch (error) {\n        iziToast.error({\n            message: `Oops! Something went wrong! ${error} Try reloading the page or make another choice!`,\n            position: 'topRight',\n            timeout: 4000,\n        });\n        gallery.innerHTML = '';\n        btnLoadMore.classList.add('is-hidden');\n    }\n});\n\nconst markUp = (data) => {\n    return data.map(({ webformatURL, tags, largeImageURL, likes, views, comments, downloads }) => {\n        return `<div class=\"photo-card\">\n        <div class=\"img_wrap\">\n            <a class=\"gallery_link\" href=\"${largeImageURL}\">\n                <img class=\"img\" src=\"${webformatURL}\" alt=\"${tags}\" width=\"300\" loading=\"lazy\" />\n            </a>\n        </div>\n        <div class=\"info\">\n            <p class=\"info-item\">\n            <b>Likes: </b><span class=\"value-num\">${likes}</span>\n            </p>\n            <p class=\"info-item\">\n            <b>Views: </b><span class=\"value-num\">${views}</span>\n            </p>\n            <p class=\"info-item\">\n            <b>Comments: </b><span class=\"value-num\">${comments}</span>\n            </p>\n            <p class=\"info-item\">\n            <b>Downloads: </b><span class=\"value-num\">${downloads}</span>\n            </p>\n        </div>\n        </div>`\n    });\n};\n\nbtnLoadMore.addEventListener('click', async () => {\n    const query = form.elements.searchQuery.value;\n    currentPage += 1;\n    try {\n        const data = await getPhotos(query.trim().toLowerCase(), currentPage, per_page);\n        gallery.insertAdjacentHTML('beforeend', markUp(data.hits).join(''));\n        if (currentPage >= Math.ceil(data.totalHits / per_page)) {\n            btnLoadMore.classList.add('is-hidden');\n            iziToast.info({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: 'topRight',\n                timeout: 4000,\n            });\n        }\n    }\n    catch (error) {\n        iziToast.error({\n            message: `Oops! Something went wrong! ${error} Try reloading the page or make another choice!`,\n            position: 'topRight',\n            timeout: 4000,\n        });\n        btnLoadMore.classList.add('is-hidden');\n    }\n});\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// import SimpleLightbox from \"simplelightbox\";\n// import \"simplelightbox/dist/simple-lightbox.min.css\";\n// import { fetchPixabayPhoto } from \"./pixabay\";\n// import iziToast from \"izitoast\";\n// import \"izitoast/dist/css/iziToast.min.css\";\n\n\n// const elems = {\n//     form: document.querySelector('.search-form'),\n//     gallery: document.querySelector('.gallery'),\n//     btnLoadMore: document.querySelector('.load-more'),\n// };\n\n// const body = document.querySelector('body');\n// let imageUrl = [];\n// function bodyBG(imageUrl) {\n\n//     if (imageUrl) {\n//         let n = (imageUrl.length - 1);\n//         let idx = Math.floor(Math.random() * n);\n//         body.style.backgroundColor = 'transparent';\n//         body.style.backgroundImage = `url(${imageUrl[idx]})`;\n//         body.style.backgroundRepeat = 'no-repeat';\n//         body.style.backgroundAttachment = 'fixed';\n//     };\n// };\n\n\n\n// const { form, gallery, btnLoadMore } = elems;\n\n\n// const perPage = 40;\n// let page = 1;\n// let keyOfSearchPhoto = '';\n// let isLoading = false;\n\n\n\n// btnLoadMore.style.display = 'none';\n\n// form.addEventListener('submit', onSubmitForm);\n\n// async function onSubmitForm(event) {\n//     event.preventDefault();\n//     const { searchQuery } = event.currentTarget.elements;\n//     imageUrl = [];\n//     let newKeyOfSearchPhoto = searchQuery.value\n//         .trim()\n//         .toLowerCase()\n//         .split(' ')\n//         .join('+');\n\n//     if (newKeyOfSearchPhoto === '') {\n//         // btnLoadMore.classList.add('is-hidden');\n//         body.style.backgroundColor = '#fff';\n//         body.style.backgroundImage = 'none';\n//         iziToast.info({\n//             message: 'Enter your request, please!',\n//             position: 'center',\n//             timeout: 4000,\n//         });\n//         gallery.innerHTML = '';\n//         return;\n//     };\n//     if (newKeyOfSearchPhoto === keyOfSearchPhoto) {\n//         iziToast.info({\n//             title: 'Info',\n//             message: `The previous ${newKeyOfSearchPhoto} request has already been received, please enter a new search parameter.`,\n//             position: 'topRight',\n//             color: 'blue',\n//         });\n//         event.currentTarget.reset();\n\n//         return;\n//     }\n//     if (newKeyOfSearchPhoto !== keyOfSearchPhoto) {\n//         window.removeEventListener('scroll', showLoadMorePage)\n//     };\n//     keyOfSearchPhoto = newKeyOfSearchPhoto;\n//     page = 1;\n//     gallery.innerHTML = '';\n//     event.currentTarget.reset();\n\n//     try {\n\n//         const { hits, total } = await fetchPixabayPhoto(keyOfSearchPhoto, page, perPage);\n\n//         if (total === 0) {\n//             // btnLoadMore.classList.add('is-hidden');\n//             body.style.backgroundColor = '#fff';\n//             iziToast.error({\n//                 message: 'Sorry, there are no images matching your search query. Please try again.',\n//                 position: 'center',\n//                 timeout: 4000,\n//             });\n//             return;\n//         };\n//         // btnLoadMore.classList.add('is-hidden');\n//         body.style.backgroundColor = '#fff';\n//         if (total <= perPage) {\n//             iziToast.success({\n//                 message: `Hooray! We found ${total} images. But it's only 1 page`,\n//                 position: 'center',\n//                 timeout: 4000,\n//             });\n//             window.removeEventListener('scroll', showLoadMorePage);\n//         } else {\n//             iziToast.success({\n//                 message: `Hooray! We found ${total} images.`,\n//                 position: 'center',\n//                 timeout: 4000,\n//             });\n//             window.addEventListener('scroll', showLoadMorePage);\n//         };\n//         createMarkup(hits);\n//         bodyBG(imageUrl);\n//         lightbox.refresh();\n//     } catch (error) {\n//         onFetchError(error.message);\n//     };\n// };\n\n// function createMarkup(searchResults) {\n//     const arrPhotos = searchResults.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n//         imageUrl.push(largeImageURL);\n//         return `<div class=\"photo-card\">\n//         <div class=\"img_wrap\">\n//             <a class=\"gallery_link\" href=\"${largeImageURL}\">\n//                 <img class=\"img\" src=\"${webformatURL}\" alt=\"${tags}\" width=\"300\" loading=\"lazy\" />\n//             </a>\n//         </div>\n//         <div class=\"info\">\n//             <p class=\"info-item\">\n//             <b>Likes: </b><span class=\"value-num\">${likes}</span>\n//             </p>\n//             <p class=\"info-item\">\n//             <b>Views: </b><span class=\"value-num\">${views}</span>\n//             </p>\n//             <p class=\"info-item\">\n//             <b>Comments: </b><span class=\"value-num\">${comments}</span>\n//             </p>\n//             <p class=\"info-item\">\n//             <b>Downloads: </b><span class=\"value-num\">${downloads}</span>\n//             </p>\n//         </div>\n//         </div>`\n//     });\n//     gallery.insertAdjacentHTML(\"beforeend\", arrPhotos.join(''));\n// };\n\n// async function onClickLoadMore() {\n//     if (checkIfEndOfPage() && !isLoading) {\n//         page += 1;\n//         // lightbox.refresh();\n\n//         try {\n\n//             isLoading = true;\n//             const { hits, totalHits } = await fetchPixabayPhoto(keyOfSearchPhoto, page, perPage);\n//             const numberOfPage = Math.ceil(totalHits / perPage);\n//             createMarkup(hits);\n//             lightbox.refresh();\n\n//             if (page === numberOfPage) {\n//                 // btnLoadMore.classList.add('is-hidden');\n//                 iziToast.info({\n//                     message: \"We're sorry, but you've reached the end of search results.\",\n//                     position: 'center',\n//                     timeout: 4000,\n//                 });\n//                 // btnLoadMore.removeEventListener('click', onClickLoadMore);\n//                 window.removeEventListener('scroll', showLoadMorePage);\n//             };\n//         } catch (error) {\n//             onFetchError(error.message);\n//         } finally {\n//             isLoading = false;\n//         };\n\n//     };\n// };\n\n// function onFetchError(error) {\n//     // btnLoadMore.classList.add('is-hidden');\n//     body.style.backgroundColor = '#fff';\n//     iziToast.error({\n//         message: `Oops! Something went wrong! ${error} Try reloading the page or make another choice!`,\n//         position: 'center',\n//         timeout: 4000,\n//     });\n// };\n\n// // function scrollPage() {\n// //     const { height: cardHeight } = gallery.firstElementChild.getBoundingClientRect();\n\n// //     window.scrollBy({\n// //         top: cardHeight * 2,\n// //         behavior: \"smooth\",\n// //     });\n// // };\n\n// function showLoadMorePage() {\n//     onClickLoadMore();\n// };\n\n// function checkIfEndOfPage() {\n//     return (\n//         window.innerHeight + window.scrollY >= document.documentElement.scrollHeight\n//     );\n// }\n\n// let lightbox = new SimpleLightbox('.img_wrap a', {\n//     captionsData: 'alt',\n//     captionDelay: 250,\n// });"],"names":["axios","API_KEY","getPhotos","q","page","per_page","reqUrl","form","gallery","btnLoadMore","currentPage","evt","query","data","iziToast","markUp","idx","bgImage","error","webformatURL","tags","largeImageURL","likes","views","comments","downloads"],"mappings":"6vBAGAA,EAAM,SAAS,QAAU,2BACzB,MAAMC,EAAU,qCAEHC,EAAY,MAAOC,EAAGC,EAAO,EAAGC,EAAW,KAAO,CAC3D,MAAMC,EAAS,QAAQL,OAAaE,UAAUC,cAAiBC,4DAE/D,OADiB,MAAML,EAAM,IAAIM,CAAM,GACvB,IACpB,ECNMC,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAc,SAAS,cAAc,YAAY,EACvD,IAAIC,EAAc,EACdL,EAAW,GACfG,EAAQ,UAAY,GAEpBC,EAAY,UAAU,IAAI,WAAW,EAErCF,EAAK,iBAAiB,SAAU,MAAOI,GAAQ,CAC3CA,EAAI,eAAc,EAClBD,EAAc,EACd,MAAME,EAAQD,EAAI,cAAc,SAAS,YAAY,MACrD,GAAI,CAEA,MAAME,EAAO,MAAMX,EAAUU,EAAM,KAAM,EAAC,YAAa,EAAEF,EAAaL,CAAQ,EAG9E,GAFA,QAAQ,IAAI,OAAQQ,CAAI,EAEpBA,EAAK,QAAU,EAAG,CAClBJ,EAAY,UAAU,IAAI,WAAW,EACrCD,EAAQ,UAAY,GACpBM,EAAS,KAAK,CACV,QAAS,4DACT,SAAU,WACV,QAAS,GACzB,CAAa,EACD,MACZ,CACQA,EAAS,KAAK,CACV,QAAS,oBAAoBD,EAAK,gBAClC,SAAU,WACV,QAAS,GACrB,CAAS,EAEDL,EAAQ,UAAYO,EAAOF,EAAK,IAAI,EAAE,KAAK,EAAE,EAC7C,IAAIG,EAAM,KAAK,MAAM,KAAK,UAAYH,EAAK,KAAK,OAAS,EAAE,EAC3D,MAAMI,EAAUJ,EAAK,KAAKG,GAAK,cAC/B,SAAS,KAAK,MAAM,gBAAkB,OAAOC,KACzCJ,EAAK,MAAQ,GACbJ,EAAY,UAAU,OAAO,WAAW,EAExCA,EAAY,UAAU,IAAI,WAAW,CAE5C,OAAQS,EAAP,CACEJ,EAAS,MAAM,CACX,QAAS,+BAA+BI,mDACxC,SAAU,WACV,QAAS,GACrB,CAAS,EACDV,EAAQ,UAAY,GACpBC,EAAY,UAAU,IAAI,WAAW,CACxC,CACL,CAAC,EAED,MAAMM,EAAUF,GACLA,EAAK,IAAI,CAAC,CAAE,aAAAM,EAAc,KAAAC,EAAM,cAAAC,EAAe,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IAC5E;AAAA;AAAA,4CAE6BJ;AAAA,wCACJF,WAAsBC;AAAA;AAAA;AAAA;AAAA;AAAA,oDAKVE;AAAA;AAAA;AAAA,oDAGAC;AAAA;AAAA;AAAA,uDAGGC;AAAA;AAAA;AAAA,wDAGCC;AAAA;AAAA;AAAA,eAInD,EAGLhB,EAAY,iBAAiB,QAAS,SAAY,CAC9C,MAAMG,EAAQL,EAAK,SAAS,YAAY,MACxCG,GAAe,EACf,GAAI,CACA,MAAMG,EAAO,MAAMX,EAAUU,EAAM,KAAM,EAAC,YAAa,EAAEF,EAAaL,CAAQ,EAC9EG,EAAQ,mBAAmB,YAAaO,EAAOF,EAAK,IAAI,EAAE,KAAK,EAAE,CAAC,EAC9DH,GAAe,KAAK,KAAKG,EAAK,UAAYR,CAAQ,IAClDI,EAAY,UAAU,IAAI,WAAW,EACrCK,EAAS,KAAK,CACV,QAAS,6DACT,SAAU,WACV,QAAS,GACzB,CAAa,EAER,OACMI,EAAP,CACIJ,EAAS,MAAM,CACX,QAAS,+BAA+BI,mDACxC,SAAU,WACV,QAAS,GACrB,CAAS,EACDT,EAAY,UAAU,IAAI,WAAW,CACxC,CACL,CAAC"}