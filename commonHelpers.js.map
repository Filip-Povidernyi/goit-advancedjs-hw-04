{"version":3,"file":"commonHelpers.js","sources":["../src/pixabay.js","../src/index.js"],"sourcesContent":["import axios from 'axios';\n\nconst URL = \"https://pixabay.com/api/\";\nconst KEY = \"40365251-7556fc461aeff4605ce69e2bc\";\n\nexport async function fetchPhoto(q, page, perPage) {\n    const url = `${URL}?key=${KEY}&q=${q}&page=${page}&per_page=${perPage}&image_type=photo&orientation=horizontal&safesearch=true`;\n    const response = await axios.get(url);\n    return response.data;\n};","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { fetchPhoto } from \"./pixabay\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n\nconst elems = {\n    searchForm: document.querySelector('.search-form'),\n    gallery: document.querySelector('.gallery'),\n    btnLoadMore: document.querySelector('.load-more'),\n};\n\nconst body = document.querySelector('body');\nlet imageUrl = [];\nfunction bodyBG(imageUrl) {\n\n    if (imageUrl) {\n        body.style.backgroundColor = 'transparent';\n        body.style.backgroundImage = `url(${imageUrl[0]})`;\n        body.style.backgroundRepeat = 'no-repeat';\n        body.style.backgroundAttachment = 'fixed';\n    };\n};\n\n\n\nconst { searchForm, gallery, btnLoadMore } = elems;\n\n\nconst perPage = 40;\nlet page = 1;\nlet keyOfSearchPhoto = '';\n\nbtnLoadMore.style.display = 'none';\n\nsearchForm.addEventListener('submit', onSubmitForm);\n\nfunction onSubmitForm(event) {\n    event.preventDefault();\n\n    gallery.innerHTML = '';\n    page = 1;\n    const { searchQuery } = event.currentTarget.elements;\n    imageUrl = [];\n    keyOfSearchPhoto = searchQuery.value\n        .trim()\n        .toLowerCase()\n        .split(' ')\n        .join('+');\n\n    if (keyOfSearchPhoto === '') {\n        btnLoadMore.classList.add('is-hidden');\n        body.style.backgroundColor = '#fff';\n        body.style.backgroundImage = 'none';\n        iziToast.info({\n            message: 'Enter your request, please!',\n            position: 'center',\n            timeout: 4000,\n        });\n        return;\n    }\n\n    fetchPhoto(keyOfSearchPhoto, page, perPage)\n        .then(data => {\n            const searchResults = data.hits;\n            if (data.totalHits === 0) {\n                btnLoadMore.classList.add('is-hidden');\n                body.style.backgroundColor = '#fff';\n                iziToast.error({\n                    message: 'Sorry, there are no images matching your search query. Please try again.',\n                    position: 'center',\n                    timeout: 4000,\n                });\n            } else {\n                btnLoadMore.classList.add('is-hidden');\n                body.style.backgroundColor = '#fff';\n                iziToast.success({\n                    message: `Hooray! We found ${data.totalHits} images.`,\n                    position: 'center',\n                    timeout: 4000,\n                });\n                createMarkup(searchResults);\n                lightbox.refresh();\n            };\n            if (data.totalHits > perPage) {\n                btnLoadMore.classList.remove('is-hidden');\n                window.addEventListener('scroll', showLoadMorePage);\n            };\n        })\n        .catch(onFetchError);\n\n    btnLoadMore.addEventListener('click', onClickLoadMore);\n\n    event.currentTarget.reset();\n};\n\nfunction createMarkup(searchResults) {\n    const arrPhotos = searchResults.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n        imageUrl.push(largeImageURL);\n        return `<div class=\"photo-card\">\n        <div class=\"img_wrap\">\n            <a class=\"gallery_link\" href=\"${largeImageURL}\">\n                <img class=\"img\" src=\"${webformatURL}\" alt=\"${tags}\" width=\"300\" loading=\"lazy\" />\n            </a>\n        </div>\n        <div class=\"info\">\n            <p class=\"info-item\">\n            <b>Likes: </b><span class=\"value-num\">${likes}</span>\n            </p>\n            <p class=\"info-item\">\n            <b>Views: </b><span class=\"value-num\">${views}</span>\n            </p>\n            <p class=\"info-item\">\n            <b>Comments: </b><span class=\"value-num\">${comments}</span>\n            </p>\n            <p class=\"info-item\">\n            <b>Downloads: </b><span class=\"value-num\">${downloads}</span>\n            </p>\n        </div>\n        </div>`\n    });\n    gallery.insertAdjacentHTML(\"beforeend\", arrPhotos.join(''));\n    bodyBG(imageUrl);\n};\n\nfunction onClickLoadMore() {\n    page += 1;\n    fetchPhoto(keyOfSearchPhoto, page, perPage)\n        .then(data => {\n            const searchResults = data.hits;\n            const numberOfPage = Math.ceil(data.totalHits / perPage);\n\n            createMarkup(searchResults);\n            if (page === numberOfPage) {\n                btnLoadMore.classList.add('is-hidden');\n                iziToast.info({\n                    message: \"We're sorry, but you've reached the end of search results.\",\n                    position: 'center',\n                    timeout: 4000,\n                });\n                btnLoadMore.removeEventListener('click', onClickLoadMore);\n                window.removeEventListener('scroll', showLoadMorePage);\n            };\n            lightbox.refresh();\n            // scrollPage();\n        })\n        .catch(onFetchError);\n};\n\nfunction onFetchError() {\n    btnLoadMore.classList.add('is-hidden');\n    body.style.backgroundColor = '#fff';\n    iziToast.error({\n        message: 'Oops! Something went wrong! Try reloading the page or make another choice!',\n        position: 'center',\n        timeout: 4000,\n    });\n};\n\n// function scrollPage() {\n//     const { height: cardHeight } = gallery.firstElementChild.getBoundingClientRect();\n\n//     window.scrollBy({\n//         top: cardHeight * 2,\n//         behavior: \"smooth\",\n//     });\n// };\n\nfunction showLoadMorePage() {\n    if (checkIfEndOfPage()) {\n        onClickLoadMore();\n    };\n};\n\nfunction checkIfEndOfPage() {\n    return (\n        window.innerHeight + window.scrollY >= document.documentElement.scrollHeight\n    );\n}\n\nlet lightbox = new SimpleLightbox('.img_wrap a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n});"],"names":["URL","KEY","fetchPhoto","q","page","perPage","url","axios","elems","body","imageUrl","bodyBG","searchForm","gallery","btnLoadMore","keyOfSearchPhoto","onSubmitForm","event","searchQuery","iziToast","data","searchResults","createMarkup","lightbox","showLoadMorePage","onFetchError","onClickLoadMore","arrPhotos","webformatURL","largeImageURL","tags","likes","views","comments","downloads","numberOfPage","checkIfEndOfPage","SimpleLightbox"],"mappings":"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"}